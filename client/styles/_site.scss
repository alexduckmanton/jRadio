$site_width: 85%;
$site_margin: ((100% - $site_width)/2) / $site_width;
$site_end_width: $site_width + $site_width * $site_margin;
$site_margin: $site_margin * 100%;
$site_speed: $default-transition-duration * 2;

@mixin site_position($x) {
    @include transform3d( translate3d($x,0,0) );

    &.show_tray {
        @include transform3d( translate3d($x,$played_height,0) );
    }
}

.site {
    padding-bottom: 2em;
    text-align: center;

    position: fixed;
    top: 0;
    right: 0;
    width: $site_width;
    height: 9999px;

    @include box-sizing(border-box);
    @include single-transition(transform);
    @include transition-property(-webkit-transform, -moz-transform, -ms-transform, -o-transform, transform);
    @include transition-duration($site_speed);

    @include site_position(0);

    &:after {
        content: '';
        position: fixed;
        width: 100%;
        height: 9999px;
        top: 0;
        left: 0;
        opacity: .8;

        @include transition-property(opacity, width);
        @include transition-duration($site_speed, 0s);
    }

    &.active {
        height: inherit;
        position: absolute;
        @include site_position(-$site_margin);

        &:after {
            // display: none;
            width: 0;
            opacity: 0;
            @include transition-delay(0, $site_speed);
        }
    }

    &.active ~ & {
        @include site_position(-100% - $site_margin);
    }

    &.active ~ &:last-child {
        width: $site_end_width;
        @include site_position(-100%);
    }

    &.active:last-child {
        width: $site_end_width;
        @include site_position(-$site_margin + .75%);
    }
}

.player {
    & + .site {
        width: $site_end_width;
        @include site_position(0);
    }
}
